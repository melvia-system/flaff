const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./DF1yqEX5.js","./BQu9ua1M.js","./entry.DwxLmr8S.css","./TextViewerMarkdown.DmXeUNvS.css","./B8ow4irH.js"])))=>i.map(i=>d[i]);
import{D as F,r as k,F as V,s as q,au as L,n as _,$,av as R,o as m,c as z,I as N,a5 as T,ap as D,_ as I,ak as P,K as B,a2 as b,w as x,x as a,b as S,t as j,d as E,am as G,a7 as H,ao as A}from"./BQu9ua1M.js";import{c as W}from"./CGH9rJHj.js";import{_ as K}from"./D4x7IiWK.js";const J=F({__name:"MonacoEditor.client",props:{lang:{default:()=>"plaintext"},options:{default:()=>({})},modelValue:{default:()=>""}},emits:["update:modelValue","load"],setup(r,{expose:C,emit:p}){const o=r,i=p,h=k(!0),u=V(()=>o.lang||o.options.language),c=q(),g=k(),d=L(),y={automaticLayout:!0};let e,f;return _(()=>o.modelValue,()=>{(e==null?void 0:e.getValue())!==o.modelValue&&(e==null||e.setValue(o.modelValue))}),_(()=>o.lang,()=>{f&&f.dispose(),f=d.editor.createModel(o.modelValue,u.value),e==null||e.setModel(f)}),_(()=>o.options,()=>{e==null||e.updateOptions($(o.options,y))}),_(g,(v,w)=>{!g.value||w||(e=d.editor.create(g.value,$(o.options,y)),f=d.editor.createModel(o.modelValue,u.value),c.value=e,e.layout(),e.setModel(f),e.onDidChangeModelContent(()=>{i("update:modelValue",e.getValue())}),h.value=!1,i("load",e))}),C({$editor:c}),R(()=>{e==null||e.dispose(),f==null||f.dispose()}),(v,w)=>(m(),z("div",{ref_key:"editorElement",ref:g},[h.value?N(v.$slots,"default",{key:0}):T("",!0)],512))}}),Q=D(()=>I(()=>import("./DF1yqEX5.js"),__vite__mapDeps([0,1,2,3]),import.meta.url).then(r=>r.default||r.default||r)),X=D(()=>I(()=>import("./B8ow4irH.js"),__vite__mapDeps([4,1,2]),import.meta.url).then(r=>r.default||r.default||r)),Y="vs-dark",Z=!0,ee=[{background:"24292e",token:""},{foreground:"959da5",token:"comment"},{foreground:"959da5",token:"punctuation.definition.comment"},{foreground:"959da5",token:"string.comment"},{foreground:"c8e1ff",token:"constant"},{foreground:"c8e1ff",token:"entity.name.constant"},{foreground:"c8e1ff",token:"variable.other.constant"},{foreground:"c8e1ff",token:"variable.language"},{foreground:"b392f0",token:"entity"},{foreground:"b392f0",token:"entity.name"},{foreground:"f6f8fa",token:"variable.parameter.function"},{foreground:"7bcc72",token:"entity.name.tag"},{foreground:"ea4a5a",token:"keyword"},{foreground:"ea4a5a",token:"storage"},{foreground:"ea4a5a",token:"storage.type"},{foreground:"f6f8fa",token:"storage.modifier.package"},{foreground:"f6f8fa",token:"storage.modifier.import"},{foreground:"f6f8fa",token:"storage.type.java"},{foreground:"79b8ff",token:"string"},{foreground:"79b8ff",token:"punctuation.definition.string"},{foreground:"79b8ff",token:"string punctuation.section.embedded source"},{foreground:"c8e1ff",token:"support"},{foreground:"c8e1ff",token:"meta.property-name"},{foreground:"fb8532",token:"variable"},{foreground:"f6f8fa",token:"variable.other"},{foreground:"d73a49",fontStyle:"bold italic underline",token:"invalid.broken"},{foreground:"d73a49",fontStyle:"bold italic underline",token:"invalid.deprecated"},{foreground:"fafbfc",background:"d73a49",fontStyle:"italic underline",token:"invalid.illegal"},{foreground:"fafbfc",background:"d73a49",fontStyle:"italic underline",token:"carriage-return"},{foreground:"d73a49",fontStyle:"bold italic underline",token:"invalid.unimplemented"},{foreground:"d73a49",token:"message.error"},{foreground:"f6f8fa",token:"string source"},{foreground:"c8e1ff",token:"string variable"},{foreground:"79b8ff",token:"source.regexp"},{foreground:"79b8ff",token:"string.regexp"},{foreground:"79b8ff",token:"string.regexp.character-class"},{foreground:"79b8ff",token:"string.regexp constant.character.escape"},{foreground:"79b8ff",token:"string.regexp source.ruby.embedded"},{foreground:"79b8ff",token:"string.regexp string.regexp.arbitrary-repitition"},{foreground:"7bcc72",fontStyle:"bold",token:"string.regexp constant.character.escape"},{foreground:"c8e1ff",token:"support.constant"},{foreground:"c8e1ff",token:"support.variable"},{foreground:"c8e1ff",token:"meta.module-reference"},{foreground:"fb8532",token:"markup.list"},{foreground:"0366d6",fontStyle:"bold",token:"markup.heading"},{foreground:"0366d6",fontStyle:"bold",token:"markup.heading entity.name"},{foreground:"c8e1ff",token:"markup.quote"},{foreground:"f6f8fa",fontStyle:"italic",token:"markup.italic"},{foreground:"f6f8fa",fontStyle:"bold",token:"markup.bold"},{foreground:"c8e1ff",token:"markup.raw"},{foreground:"b31d28",background:"ffeef0",token:"markup.deleted"},{foreground:"b31d28",background:"ffeef0",token:"meta.diff.header.from-file"},{foreground:"b31d28",background:"ffeef0",token:"punctuation.definition.deleted"},{foreground:"176f2c",background:"f0fff4",token:"markup.inserted"},{foreground:"176f2c",background:"f0fff4",token:"meta.diff.header.to-file"},{foreground:"176f2c",background:"f0fff4",token:"punctuation.definition.inserted"},{foreground:"b08800",background:"fffdef",token:"markup.changed"},{foreground:"b08800",background:"fffdef",token:"punctuation.definition.changed"},{foreground:"2f363d",background:"959da5",token:"markup.ignored"},{foreground:"2f363d",background:"959da5",token:"markup.untracked"},{foreground:"b392f0",fontStyle:"bold",token:"meta.diff.range"},{foreground:"c8e1ff",token:"meta.diff.header"},{foreground:"0366d6",fontStyle:"bold",token:"meta.separator"},{foreground:"0366d6",token:"meta.output"},{foreground:"ffeef0",token:"brackethighlighter.tag"},{foreground:"ffeef0",token:"brackethighlighter.curly"},{foreground:"ffeef0",token:"brackethighlighter.round"},{foreground:"ffeef0",token:"brackethighlighter.square"},{foreground:"ffeef0",token:"brackethighlighter.angle"},{foreground:"ffeef0",token:"brackethighlighter.quote"},{foreground:"d73a49",token:"brackethighlighter.unmatched"},{foreground:"d73a49",token:"sublimelinter.mark.error"},{foreground:"fb8532",token:"sublimelinter.mark.warning"},{foreground:"6a737d",token:"sublimelinter.gutter-mark"},{foreground:"79b8ff",fontStyle:"underline",token:"constant.other.reference.link"},{foreground:"79b8ff",fontStyle:"underline",token:"string.other.link"}],oe={"editor.foreground":"#f6f8fa","editor.background":"#24292e","editor.selectionBackground":"#4c2889","editor.inactiveSelectionBackground":"#444d56","editor.lineHighlightBackground":"#444d56","editorCursor.foreground":"#ffffff","editorWhitespace.foreground":"#6a737d","editorIndentGuide.background":"#6a737d","editorIndentGuide.activeBackground":"#f6f8fa","editor.selectionHighlightBorder":"#444d56"},te={base:Y,inherit:Z,rules:ee,colors:oe},ne=W(J),re={class:"flex flex-1 w-full h-full"},ae={class:"text-sm pl-2 text-slate-200"},le=F({__name:"Text.client",props:{flaffId:{type:String,required:!0},item:{type:Object,required:!0},flaff:{type:Object,required:!0},mimeType:{type:String,required:!0}},emits:["flaffUpdated","changeFileByName"],setup(r,{emit:C}){const p=L();p&&(p.editor.defineTheme("GitHubDark",te),p.editor.setTheme("GitHubDark"));const o=r,i=k("");k();const h=V(()=>({automaticLayout:!0,readOnly:!o.flaff.isOwner,width:"100%",height:"100%"})),u=P(),c=k(!0),g=async()=>{c.value=!0;try{const l=await(await $fetch(`/api/flaff/${o.flaffId}/file/${o.item.uuid}`,{responseType:"blob"})).text();i.value=l}catch(n){console.error("error",n)}c.value=!1};B(()=>{g()});const d=V(()=>o.mimeType.split("/")[1]||"text/plain"),y=async()=>{try{const n=new File([i.value],o.item.name,{type:o.item.mimeType}),t=new FormData;t.append("file",n);const l=await $fetch(`/api/flaff/${o.flaffId}/file/${o.item.uuid}`,{method:"PUT",body:t});console.log("res",l),u.add({title:"Success",description:"File saved"})}catch(n){console.error("error",n),u.add({title:"Error",description:"Failed to save file"})}},e=k("editor"),f=["markdown"];B(()=>{f.includes(d.value)&&(e.value="viewer")});const v={markdown:Q},w=V(()=>{const n=X,t=d.value;return v[t]||n}),O=async()=>{try{await navigator.clipboard.writeText(i.value),u.add({title:"Success",description:"Text copied to clipboard"})}catch(n){console.error("error",n),u.add({title:"Error",description:"Failed to copy text to clipboard"})}};return(n,t)=>{const l=A,M=ne,U=K;return m(),b(U,{isLoading:a(c),item:o.item,"flaff-id":o.flaffId,"is-mime-readable":!0,mimeType:"text/*",flaff:r.flaff,onFlaffUpdated:t[4]||(t[4]=(...s)=>n.$emit("flaffUpdated",...s))},{"header-actions":x(()=>[a(e)=="editor"&&o.flaff.isOwner?(m(),b(l,{key:0,onClick:y,icon:"i-ph-upload",size:"xs",label:"Save"})):T("",!0),a(e)=="editor"?(m(),b(l,{key:1,onClick:O,icon:"i-ph-copy",size:"xs",label:"Copy to clipboard"})):T("",!0)]),"footer-bar":x(()=>[S("span",ae," Lang: "+j(a(d)),1)]),"footer-actions":x(()=>[S("div",null,[E(l,{color:a(e)=="viewer"?void 0:"white",label:"Viewer",icon:"i-ph-eye",size:"xs",class:"rounded-r-none",onClick:t[2]||(t[2]=s=>e.value="viewer")},null,8,["color"]),E(l,{color:a(e)=="editor"?void 0:"white",label:"Editor",icon:"i-ph-code",size:"xs",class:"rounded-l-none",onClick:t[3]||(t[3]=s=>e.value="editor")},null,8,["color"])])]),default:x(()=>[S("div",re,[a(e)=="editor"?(m(),b(M,{key:0,modelValue:a(i),"onUpdate:modelValue":t[0]||(t[0]=s=>G(i)?i.value=s:null),language:a(d),lang:a(d),options:a(h),class:"editor w-[100%]",width:"100%",height:"100%",the:""},null,8,["modelValue","language","lang","options"])):(m(),b(H(a(w)),{key:1,"flaff-id":o.flaffId,item:o.item,flaff:r.flaff,mimeType:o.mimeType,data:a(i),onChangeFileByName:t[1]||(t[1]=s=>n.$emit("changeFileByName",s))},null,40,["flaff-id","item","flaff","mimeType","data"]))])]),_:1},8,["isLoading","item","flaff-id","flaff"])}}});export{le as default};
