const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./DslTR6Ao.js","./C-_mO8Uk.js","./entry.CHj6Egbx.css","./CNmcvJ2i.js","./BKsKTsL0.js","./DJYDGJE-.js","./B5KcCl12.js"])))=>i.map(i=>d[i]);
import{D as j,F as d,o as p,a2 as b,w as v,b as i,d as f,t as y,c as V,a5 as k,I as x,e as E,x as r,Y as B,ao as R,ap as w,_ as h,r as I,a7 as C}from"./C-_mO8Uk.js";import{_ as F,c as O}from"./CNmcvJ2i.js";const A={class:"flex justify-between"},M={class:"flex items-center gap-2"},D={key:0},P={class:"flex gap-2"},z={key:0,class:"flex-1 flex justify-center items-center"},S={class:"flex items-center gap-1"},U=i("span",null,"Loading Image Preview",-1),q={class:"flex justify-between"},N={class:"flex items-center gap-2 divide-x divide-gray-500"},G={class:"flex items-center gap-1 text-sm"},K={class:"pl-2 flex items-center gap-1 text-sm"},X={class:"flex gap-2"},Y=j({__name:"FileViewerContainer",props:{flaffId:{type:String,required:!0},item:{type:Object,required:!0},forceViewerMimeType:{type:String},isMimeReadable:{type:Boolean,default:!0},mimeType:{type:String,required:!0},isLoading:{type:Boolean,default:!1},flaff:{type:Object,required:!0}},setup(e){const s=e,u=d(()=>{const t=s.item.size;return t<1024?`${t} B`:t<1024*1024?`${(t/1024).toFixed(2)} KB`:t<1024*1024*1024?`${(t/1024/1024).toFixed(2)} MB`:`${(t/1024/1024/1024).toFixed(2)} GB`}),l=async()=>{try{const t=await $fetch(`/api/flaff/${s.flaffId}/file/${s.item.uuid}`,{responseType:"blob"}),c=URL.createObjectURL(t),o=document.createElement("a");o.href=c,o.download=s.item.name,o.click(),URL.revokeObjectURL(c)}catch(t){console.error("error",t)}};return(t,c)=>{const o=B,_=R,g=F;return p(),b(g,{class:"flex-1 flex flex-col",ui:{body:{base:"flex-1 flex overflow-y-auto",padding:"p-0 sm:p-0"}}},{header:v(()=>[i("div",A,[i("div",M,[f(o,{name:"i-ph-file-duotone"}),i("span",null,y(e.item.name),1),e.forceViewerMimeType?(p(),V("span",D,"["+y(e.forceViewerMimeType)+"]",1)):k("",!0)]),i("div",P,[x(t.$slots,"header-actions")])])]),footer:v(()=>[i("div",q,[i("div",N,[i("div",G,[f(o,{name:"i-ph-file-duotone"}),E(" "+y(r(u)),1)]),i("div",K,[f(o,{name:"i-ph-file-duotone"}),E(" "+y(e.item.mimeType),1)]),x(t.$slots,"footer-bar")]),i("div",X,[x(t.$slots,"footer-actions"),f(_,{color:"white",label:"Download",icon:"i-ph-download",size:"xs",onClick:l})])])]),default:v(()=>[e.isLoading?(p(),V("div",z,[i("div",S,[U,f(o,{name:"i-ph-circle-notch-duotone",class:"animate-spin"})])])):x(t.$slots,"default",{key:1})]),_:3})}}}),Z=w(()=>h(()=>import("./DslTR6Ao.js"),__vite__mapDeps([0,1,2,3]),import.meta.url).then(e=>e.default||e.default||e)),H=w(()=>h(()=>import("./BKsKTsL0.js"),__vite__mapDeps([4,1,2,3]),import.meta.url).then(e=>e.default||e.default||e)),J=w(()=>h(()=>import("./DJYDGJE-.js"),__vite__mapDeps([5,1,2,3]),import.meta.url).then(e=>O(e.default||e.default||e))),Q=w(()=>h(()=>import("./B5KcCl12.js"),__vite__mapDeps([6,1,2,3]),import.meta.url).then(e=>e.default||e.default||e)),W={class:"flex-1 flex justify-center items-center"},ee={class:"flex flex-col justify-center items-center gap-1"},te=i("span",null,"Preview Not Available",-1),ie=j({__name:"FileViewer.client",props:{flaffId:{type:String,required:!0},item:{type:Object,required:!0},flaff:{type:Object,required:!0}},setup(e){const s=e,u={ps:"text/pinescript",pinescript:"text/pinescript",sav:"text/sav",ts:"text/typescript",tsx:"text/typescript",js:"text/javascript",jsx:"text/javascript",json:"text/json",yml:"text/yaml",yaml:"text/yaml",md:"text/markdown",markdown:"text/markdown",csv:"text/csv"},l=d(()=>{const n=s.item.extension,a=s.item.mimeType;return u[n]?u[n]:a}),t=["application/pdf","text/*","image/*"],c=d(()=>{const n=l.value;return t.some(a=>new RegExp(a.replace("*",".*")).test(n))}),o={"image/*":Z,"application/pdf":H,"text/*":J},_=n=>{const a=Object.entries(o).find(([T])=>new RegExp(T.replace("*",".*")).test(l.value));return a==null?void 0:a[1]},g=d(()=>{const n=Q;return _(l.value)||n}),m=I(),L=d(()=>{if(m.value){const n=_(m.value);if(n)return n}return g.value});return(n,a)=>{const T=R,$=Y;return r(c)||r(m)?(p(),b(C(r(L)),{key:0,"flaff-id":e.flaffId,item:e.item,mimeType:r(l),flaff:e.flaff},null,8,["flaff-id","item","mimeType","flaff"])):(p(),b($,{key:1,flaff:e.flaff,"flaff-id":s.flaffId,"force-viewer-mime-type":r(m),"is-mime-readable":r(c),item:s.item,mimeType:r(l)},{default:v(()=>[i("div",W,[i("div",ee,[te,f(T,{label:"Read as Text",size:"xs",onClick:a[0]||(a[0]=ne=>m.value="text/plain")})])])]),_:1},8,["flaff","flaff-id","force-viewer-mime-type","is-mime-readable","item","mimeType"]))}}}),se=Object.freeze(Object.defineProperty({__proto__:null,default:ie},Symbol.toStringTag,{value:"Module"}));export{se as F,Y as _};
