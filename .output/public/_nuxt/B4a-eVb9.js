const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./C2lY0Gyl.js","./CoVIpJ9u.js","./entry.CHj6Egbx.css","./Dj1bnOkD.js","./BfHzdStZ.js","./mq-KkNWq.js","./gWk44Pyi.js"])))=>i.map(i=>d[i]);
import{C as j,E as d,o as p,a1 as b,w as v,b as i,d as f,t as y,c as E,a4 as k,H as x,e as V,v as r,X as B,an as R,ao as w,_ as h,r as C,a6 as I}from"./CoVIpJ9u.js";import{_ as O,c as F}from"./Dj1bnOkD.js";const A={class:"flex justify-between"},M={class:"flex items-center gap-2"},P={key:0},z={class:"flex gap-2"},D={key:0,class:"flex-1 flex justify-center items-center"},S={class:"flex items-center gap-1"},U=i("span",null,"Loading Image Preview",-1),q={class:"flex justify-between"},N={class:"flex items-center gap-2 divide-x divide-gray-500"},X={class:"flex items-center gap-1 text-sm"},G={class:"pl-2 flex items-center gap-1 text-sm"},H={class:"flex gap-2"},K=j({__name:"FileViewerContainer",props:{flaffId:{type:String,required:!0},item:{type:Object,required:!0},forceViewerMimeType:{type:String},isMimeReadable:{type:Boolean,default:!0},mimeType:{type:String,required:!0},isLoading:{type:Boolean,default:!1},flaff:{type:Object,required:!0}},setup(e){const s=e,u=d(()=>{const t=s.item.size;return t<1024?`${t} B`:t<1024*1024?`${(t/1024).toFixed(2)} KB`:t<1024*1024*1024?`${(t/1024/1024).toFixed(2)} MB`:`${(t/1024/1024/1024).toFixed(2)} GB`}),l=async()=>{try{const t=await $fetch(`/api/flaff/${s.flaffId}/file/${s.item.uuid}`,{responseType:"blob"}),c=URL.createObjectURL(t),o=document.createElement("a");o.href=c,o.download=s.item.name,o.click(),URL.revokeObjectURL(c)}catch(t){console.error("error",t)}};return(t,c)=>{const o=B,_=R,g=O;return p(),b(g,{class:"flex-1 flex flex-col",ui:{body:{base:"flex-1 flex overflow-y-auto",padding:"p-0 sm:p-0"}}},{header:v(()=>[i("div",A,[i("div",M,[f(o,{name:"i-ph-file-duotone"}),i("span",null,y(e.item.name),1),e.forceViewerMimeType?(p(),E("span",P,"["+y(e.forceViewerMimeType)+"]",1)):k("",!0)]),i("div",z,[x(t.$slots,"header-actions")])])]),footer:v(()=>[i("div",q,[i("div",N,[i("div",X,[f(o,{name:"i-ph-file-duotone"}),V(" "+y(r(u)),1)]),i("div",G,[f(o,{name:"i-ph-file-duotone"}),V(" "+y(e.item.mimeType),1)]),x(t.$slots,"footer-bar")]),i("div",H,[x(t.$slots,"footer-actions"),f(_,{color:"white",label:"Download",icon:"i-ph-download",size:"xs",onClick:l})])])]),default:v(()=>[e.isLoading?(p(),E("div",D,[i("div",S,[U,f(o,{name:"i-ph-circle-notch-duotone",class:"animate-spin"})])])):x(t.$slots,"default",{key:1})]),_:3})}}}),Z=w(()=>h(()=>import("./C2lY0Gyl.js"),__vite__mapDeps([0,1,2,3]),import.meta.url).then(e=>e.default||e.default||e)),J=w(()=>h(()=>import("./BfHzdStZ.js"),__vite__mapDeps([4,1,2,3]),import.meta.url).then(e=>e.default||e.default||e)),Q=w(()=>h(()=>import("./mq-KkNWq.js"),__vite__mapDeps([5,1,2,3]),import.meta.url).then(e=>F(e.default||e.default||e))),W=w(()=>h(()=>import("./gWk44Pyi.js"),__vite__mapDeps([6,1,2,3]),import.meta.url).then(e=>e.default||e.default||e)),Y={class:"flex-1 flex justify-center items-center"},ee={class:"flex flex-col justify-center items-center gap-1"},te=i("span",null,"Preview Not Available",-1),ie=j({__name:"FileViewer.client",props:{flaffId:{type:String,required:!0},item:{type:Object,required:!0},flaff:{type:Object,required:!0}},setup(e){const s=e,u={ps:"text/pinescript",pinescript:"text/pinescript",sav:"text/sav",ts:"text/typescript",tsx:"text/typescript",js:"text/javascript",jsx:"text/javascript",json:"text/json",yml:"text/yaml",yaml:"text/yaml",md:"text/markdown",markdown:"text/markdown",csv:"text/csv"},l=d(()=>{const n=s.item.extension,a=s.item.mimeType;return u[n]?u[n]:a}),t=["application/pdf","text/*","image/*"],c=d(()=>{const n=l.value;return t.some(a=>new RegExp(a.replace("*",".*")).test(n))}),o={"image/*":Z,"application/pdf":J,"text/*":Q},_=n=>{const a=Object.entries(o).find(([T])=>new RegExp(T.replace("*",".*")).test(l.value));return a==null?void 0:a[1]},g=d(()=>{const n=W;return _(l.value)||n}),m=C(),L=d(()=>{if(m.value){const n=_(m.value);if(n)return n}return g.value});return(n,a)=>{const T=R,$=K;return r(c)||r(m)?(p(),b(I(r(L)),{key:0,"flaff-id":e.flaffId,item:e.item,mimeType:r(l),flaff:e.flaff},null,8,["flaff-id","item","mimeType","flaff"])):(p(),b($,{key:1,flaff:e.flaff,"flaff-id":s.flaffId,"force-viewer-mime-type":r(m),"is-mime-readable":r(c),item:s.item,mimeType:r(l)},{default:v(()=>[i("div",Y,[i("div",ee,[te,f(T,{label:"Read as Text",size:"xs",onClick:a[0]||(a[0]=ne=>m.value="text/plain")})])])]),_:1},8,["flaff","flaff-id","force-viewer-mime-type","is-mime-readable","item","mimeType"]))}}}),se=Object.freeze(Object.defineProperty({__proto__:null,default:ie},Symbol.toStringTag,{value:"Module"}));export{se as F,K as _};
